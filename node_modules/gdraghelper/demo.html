<html>
<head>
	<title>GDragHelper Demo</title>
</head>

<body>

	<!-- the box we'll drag -->
	<div id="draggableBox">
		<span>Drag Me</span>
	</div>

</body>

<!-- styles -->
<style lang="css">

	body {
		touch-action: none;
	}

	#draggableBox {

		/* make pointer look draggable & disable drag-to-select browser behavior (so text wont try to highlight) */
		cursor: move;
		user-select: none;

		/* we'll use absolute positioning for the boxes coordinates */
		position: absolute;

		/* make it a pretty teal square */
		width: 100px;
		height: 100px;
		background: #00ABAE;

		/* bonus styling: shadow & nice corners */
		border-radius: 15px;
		filter: drop-shadow(2px 2px 2px rgba(0, 0, 0, 0.4));

		/* put text in center */
		span {

			width: 100%;

			/* text positing & settings */
			font-family: sans-serif;
			text-align: center;
			font-weight: bolder;
			color: white;

			/* lazy center hack */
			position: absolute;
			left: 50%;
			top: 50%;
			transform: translate(-50%, -50%);
		}

	}

</style>

<!-- main code to set up dragging -->
<script type="module">

	// import our drag helper lib
	import DragHelper from './DragHelper.js';

	// get the reference to the box
	const draggableBoxEl = document.getElementById('draggableBox');

	// we'll store the boxes position in this object
	const boxPos = {
		x: 0,
		y: 0,
	};

	window.bp = boxPos;

	// make FN that positions our box position both in the variable & it's DOM style
	const updateBoxPos = (x, y)=>{
		boxPos.x = x;
		boxPos.y = y;
		draggableBoxEl.style.left = `${boxPos.x}px`;
		draggableBoxEl.style.top = `${boxPos.y}px`;
	};

	// update the box once on start up to our default values
	updateBoxPos(0, 0);

	// make a new, reusable drag helper that uses pointer events instead of the default mousedown/mousemove/mouseup vents
	const dragHelper = new DragHelper({ usePointerEvents: true });

	// when the mouse is down over the box, we'll set up the drag operation to test/demonstrate the drag helper in action
	draggableBoxEl.addEventListener('pointerdown', (event)=>{

		// save the initial position the box is at, because we'll just add deltas to it
		const dragStartPos = {
			x: boxPos.x,
			y: boxPos.y
		};

		console.log(dragStartPos)

		// while we're dragging we'll make the box purple
		draggableBoxEl.style.background = '#9131F9';

		// set up a new drag operation
		dragHelper.dragStart(

			// this callback will get delta X and delta Y movement positions every "frame" of the drag (when pointer moves, etc)
			(dx, dy)=>{

				// get a new position but subtracting the mouse deltas from the position the box was when we started dragging
				// (because delta x and delta y are compared to where the drag _started_)
				const newPos = {
					x: dragStartPos.x - dx,
					y: dragStartPos.y - dy
				};

				// move the box
				updateBoxPos(newPos.x, newPos.y);
			},

			// this callback will run once when the drag operation ends (i.e. the mouse/pointer/touch was up/ended)
			(dx, dy)=>{

				// reset it's background color when the drag ends
				draggableBoxEl.style.background = '#00ABAE';
			}
		)
	});
</script>
</html>
